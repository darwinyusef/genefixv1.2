<!DOCTYPE html>
<html lang="en">

<head>
    <title>Genefix | Reporte final</title>
    <!-- HTML5 Shim and Respond.js IE11 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 11]>
    	<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    	<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    	<![endif]-->
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="" />
    <meta name="keywords" content="">
    <meta name="author" content="Phoenixcoded" />

    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">

    <!-- font css -->
    <link rel="stylesheet" href="assets/fonts/font-awsome-pro/css/pro.min.css">
    <link rel="stylesheet" href="assets/fonts/feather.css">
    <link rel="stylesheet" href="assets/fonts/fontawesome.css">

    <!-- vendor css -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/customizer.css">
    <link id="rol_user" rel="stylesheet" href="assets/css/change_loggin.css">
    <link id="rol_admin" rel="stylesheet" href="assets/css/typeadmin.css">
    <style>
        /* Contenedor de filtros mejorado */
        .filters-container {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: flex-end;
            margin-bottom: 25px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.2);
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
            min-width: 150px;
        }

        .filter-group label {
            font-weight: 600;
            font-size: 0.85rem;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .filter-group input,
        .filter-group select {
            padding: 10px 15px;
            border: 2px solid transparent;
            border-radius: 8px;
            font-size: 0.95rem;
            background-color: #ffffff;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .btn-search {
            padding: 11px 30px;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 10px rgba(56, 239, 125, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-top: auto;
        }

        .btn-search:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(56, 239, 125, 0.4);
        }

        .btn-search:active {
            transform: translateY(0);
        }

        /* Tabla mejorada */
        #data-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            margin-top: 20px;
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        #data-table thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        #data-table th {
            padding: 16px 12px;
            text-align: left;
            font-weight: 600;
            color: white;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            border: none;
        }

        #data-table tbody tr {
            border-bottom: 1px solid #f0f0f0;
            transition: all 0.2s ease;
        }

        #data-table tbody tr:nth-child(even) {
            background-color: #f9fafb;
        }

        #data-table tbody tr:hover {
            background-color: #f0f4ff;
            transform: scale(1.01);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.15);
        }

        #data-table td {
            padding: 14px 12px;
            border: none;
            color: #374151;
            font-size: 0.9rem;
        }

        #data-table td a {
            color: #667eea;
            text-decoration: none;
            font-weight: 600;
            padding: 4px 12px;
            border-radius: 6px;
            transition: all 0.2s ease;
            display: inline-block;
        }

        #data-table td a:hover {
            background-color: #667eea;
            color: white;
            transform: translateY(-1px);
        }

        /* Paginación mejorada */
        .pagination-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
            padding: 20px;
        }

        .btn-pagination {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.3);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-pagination:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .btn-pagination:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        #page-info {
            font-weight: 600;
            color: #374151;
            padding: 10px 20px;
            background: #f3f4f6;
            border-radius: 8px;
            min-width: 100px;
            text-align: center;
        }

        /* Month Year Picker mejorado */
        .month-year-picker {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 1px solid #e5e7eb;
            border-radius: 8px;
            text-transform: uppercase;
            background: white;
        }

        .nav-button {
            padding: 8px 12px;
            cursor: pointer;
            border: none;
            background-color: #667eea;
            color: white;
            border-radius: 6px;
            transition: all 0.2s ease;
        }

        .nav-button:hover {
            background-color: #5568d3;
            transform: scale(1.05);
        }

        .current-month-year {
            font-size: 1.1em;
            font-weight: 600;
            color: #374151;
        }

        .month-year-picker:nth-child(1) {
            display: none;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .filters-container {
                flex-direction: column;
            }

            .filter-group {
                width: 100%;
            }

            .btn-search {
                width: 100%;
            }

            #data-table {
                font-size: 0.8rem;
            }

            #data-table th,
            #data-table td {
                padding: 10px 8px;
            }

            .pagination-container {
                flex-wrap: wrap;
            }
        }

        /* Table Wrapper para scroll horizontal en móviles */
        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            border-radius: 12px;
        }

        /* Estilos para estados vacíos */
        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #9ca3af;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        /* Botón de acciones en tabla */
        .btn-action {
            padding: 6px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
            box-shadow: 0 2px 5px rgba(102, 126, 234, 0.3);
            display: inline-flex;
            align-items: center;
            gap: 5px;
        }

        .btn-action:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.4);
        }

        .btn-action i {
            width: 14px;
            height: 14px;
        }

        /* Estilos del Modal */
        #detallesModal .modal-content {
            border: none;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.15);
        }

        #detallesModal .modal-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 16px 16px 0 0;
            padding: 20px 25px;
            border: none;
        }

        #detallesModal .modal-title {
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        #detallesModal .close {
            color: white;
            opacity: 1;
            text-shadow: none;
            font-size: 1.5rem;
        }

        #detallesModal .close:hover {
            color: #f0f0f0;
        }

        #detallesModal .modal-body {
            padding: 25px;
        }

        .details-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .detail-section {
            background: #f9fafb;
            border-radius: 10px;
            padding: 18px;
            border-left: 4px solid #667eea;
        }

        .section-title {
            font-weight: 700;
            color: #374151;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .section-title i {
            color: #667eea;
            width: 18px;
            height: 18px;
        }

        .detail-item {
            margin-bottom: 12px;
            display: flex;
            align-items: baseline;
            gap: 8px;
        }

        .detail-item:last-child {
            margin-bottom: 0;
        }

        .detail-item.full-width {
            flex-direction: column;
        }

        .detail-label {
            font-weight: 600;
            color: #6b7280;
            font-size: 0.85rem;
            min-width: 120px;
        }

        .detail-value {
            color: #1f2937;
            font-size: 0.95rem;
            word-wrap: break-word;
        }

        .detail-value.highlight {
            color: #667eea;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .detail-value.badge-status {
            padding: 4px 12px;
            border-radius: 20px;
            background: #10b981;
            color: white;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
            display: inline-block;
        }

        .concepto-text {
            background: white;
            padding: 15px;
            border-radius: 8px;
            line-height: 1.6;
            border: 1px solid #e5e7eb;
            margin: 0;
        }

        #detallesModal .modal-footer {
            border-top: 1px solid #e5e7eb;
            padding: 15px 25px;
            background: #f9fafb;
            border-radius: 0 0 16px 16px;
        }

        #detallesModal .modal-footer .btn {
            padding: 8px 20px;
            border-radius: 8px;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 6px;
        }

        /* Responsive modal */
        @media (max-width: 768px) {
            .detail-item {
                flex-direction: column;
                gap: 4px;
            }

            .detail-label {
                min-width: auto;
            }
        }
    </style>
</head>

<body class="">

    <div class="loader-wrapper">
        <span class="loader"></span>
    </div>

    <div id="alerta" class="alert animate__animated" role="alert" style="display: none;">
        A simple primary alert—check it out!
    </div>
    <!-- [ Pre-loader ] start -->
    <div class="loader-bg">
        <div class="loader-track">
            <div class="loader-fill"></div>
        </div>
    </div>
    <!-- [ Pre-loader ] End -->
    <!-- [ Mobile header ] start -->
    <div class="pc-mob-header pc-header">
        <div class="pcm-logo">
            <img src="assets/images/logo.png" alt="" class="logo logo-lg">
        </div>
        <div class="pcm-toolbar">
            <a href="#!" class="pc-head-link" id="mobile-collapse">
                <div class="hamburger hamburger--arrowturn">
                    <div class="hamburger-box">
                        <div class="hamburger-inner"></div>
                    </div>
                </div>
                <!-- <i data-feather="menu"></i> -->
            </a>
            <a href="#!" class="pc-head-link" id="headerdrp-collapse">
                <i data-feather="align-right"></i>
            </a>
            <a href="#!" class="pc-head-link" id="header-collapse">
                <i data-feather="more-vertical"></i>
            </a>
        </div>
    </div>
    <!-- [ Mobile header ] End -->

    <!-- [ navigation menu ] start -->
    <nav class="pc-sidebar ">
        <div class="navbar-wrapper">
            <div class="m-header">
                <a href="home.html" class="b-brand">
                    <!-- ========   change your logo hear   ============ -->
                    <img src="assets/images/logo.png" alt="" class="logo logo-lg">
                    <img src="assets/images/logo-sm.png" alt="" class="logo logo-sm">
                </a>
            </div>
            <div class="navbar-content">
                <ul id="pc-navbar" class="pc-navbar"></ul>
            </div>

        </div>
    </nav>
    <!-- [ navigation menu ] end -->
    <!-- [ Header ] start -->
    <header class="pc-header ">
        <div class="header-wrapper">
            <div class="mr-auto pc-mob-drp">
                <ul class="list-unstyled">
                    <li class="dropdown pc-h-item">
                        <a class="btn_acciones pc-head-link active dropdown-toggle arrow-none mr-0"
                            data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                            Acciones
                        </a>
                        <div class="dropdown-menu pc-h-dropdown">
                            <a href="profile-update.html" class="dropdown-item">
                                <i data-feather="user"></i>
                                <span>Perfil</span>
                            </a>
                            <!-- <a href="#!" class="dropdown-item">
                                <i data-feather="life-buoy"></i>
                                <span>Support</span>
                            </a> -->
                            <button onclick="logout()" class="dropdown-item">
                                <i data-feather="power"></i>
                                <span>Logout</span>
                            </button>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="ml-auto">
                <ul class="list-unstyled">
                    <li class="dropdown pc-h-item">

                        <div class="dropdown-menu dropdown-menu-right pc-h-dropdown drp-search">
                            <form class="px-3">
                                <div class="form-group mb-0 d-flex align-items-center">
                                    <i data-feather="search"></i>
                                    <input type="search" class="form-control border-0 shadow-none"
                                        placeholder="Search here. . .">
                                </div>
                            </form>
                        </div>
                    </li>
                    <li class="dropdown pc-h-item">
                        <a class="pc-head-link dropdown-toggle arrow-none mr-0" data-toggle="dropdown" href="#"
                            role="button" aria-haspopup="false" aria-expanded="false">
                            <img src="assets/images/user/avatar-5.jpg" alt="user-image" class="user-avtar">
                            <span>
                                <span class="user-name"></span>
                                <span class="user-desc"></span>
                            </span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right pc-h-dropdown">
                            <div class=" dropdown-header">
                                <h6 class="text-overflow m-0">Bienvenido</h6>
                            </div>
                            <a href="profile-update.html" class="dropdown-item">
                                <i data-feather="user"></i>
                                <span>Mi perfil</span>
                            </a>

                            <!-- <a href="#!" class="dropdown-item">
                                <i data-feather="life-buoy"></i>
                                <span>Support</span>
                            </a> -->

                            <button onclick="logout()" class="dropdown-item">
                                <i data-feather="power"></i>
                                <span>Logout</span>
                            </button>
                        </div>
                    </li>
                </ul>
            </div>

        </div>
    </header>
    <!-- [ Header ] end -->

    <!-- [ Main Content ] start -->
    <div class="pc-container">
        <div class="pcoded-content">
            <!-- [ breadcrumb ] start -->
            <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <p class="m-b-10">Causación contable | reporte final </p>
                            </div>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="index.html">Mis reportes</a></li>
                                <!--li class="breadcrumb-item">Sample Page</li-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- [ breadcrumb ] end -->
            <!-- [ Main Content ] start -->
            <div class="row">

                <!-- [ sample-page ] start -->
                <div class="col-sm-12">
                    <div class="card">
                        <div class="card-header">
                            <h5>Bienvenido a tu Panel de Control</h5>
                        </div>


                        <div class="card-body">

                            <!-- Filtros mejorados -->
                            <div class="filters-container">
                                <div class="filter-group">
                                    <label for="anio">Año</label>
                                    <input type="number" id="anio" value="" min="1930" max="2099" placeholder="2024">
                                </div>

                                <div class="filter-group">
                                    <label for="mes">Mes</label>
                                    <select id="mes">
                                        <option disabled selected value="">Seleccione...</option>
                                        <option value="enero">Enero</option>
                                        <option value="febrero">Febrero</option>
                                        <option value="marzo">Marzo</option>
                                        <option value="abril">Abril</option>
                                        <option value="mayo">Mayo</option>
                                        <option value="junio">Junio</option>
                                        <option value="julio">Julio</option>
                                        <option value="agosto">Agosto</option>
                                        <option value="septiembre">Septiembre</option>
                                        <option value="octubre">Octubre</option>
                                        <option value="noviembre">Noviembre</option>
                                        <option value="diciembre">Diciembre</option>
                                    </select>
                                </div>

                                <button class="btn-search" onclick="loadData()">
                                    <i data-feather="search"></i> Buscar
                                </button>
                            </div>

                            <!-- Tabla con wrapper para scroll horizontal -->
                            <div class="table-wrapper">
                                <table id="data-table">
                                    <thead>
                                        <tr>
                                            <th>ID</th>
                                            <th>Fecha</th>
                                            <th>Valor</th>
                                            <th>Cuenta</th>
                                            <th>Estado Begranda</th>
                                            <th>Concepto</th>
                                            <th>Acciones</th>
                                        </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>

                            <!-- Paginación mejorada -->
                            <div class="pagination-container">
                                <button class="btn-pagination" onclick="previousPage()" id="btn-prev">
                                    <i data-feather="chevron-left"></i> Anterior
                                </button>
                                <span id="page-info"></span>
                                <button class="btn-pagination" onclick="nextPage()" id="btn-next">
                                    Siguiente <i data-feather="chevron-right"></i>
                                </button>
                            </div>




                        </div>
                    </div>
                </div>

                <!-- [ sample-page ] end -->
            </div>
            <!-- [ Main Content ] end -->
        </div>
    </div>
    <!-- [ Main Content ] end -->
    </div>

    <!-- Modal de Detalles -->
    <div class="modal fade" id="detallesModal" tabindex="-1" role="dialog" aria-labelledby="detallesModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable" role="document">
            <div class="modal-content shadow-lg border-0">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title d-flex align-items-center" id="detallesModalLabel">
                        <i data-feather="file-text" class="mr-2"></i>
                        Detalles de la Causación Contable
                    </h5>
                    <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-4">
                    <div class="details-container">
                        <!-- Sección: Información General -->
                        <div class="detail-section">
                            <h6 class="section-title">
                                <i data-feather="info"></i> Información General
                            </h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">ID:</span>
                                        <span class="detail-value" id="modal-id">-</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">Fecha:</span>
                                        <span class="detail-value" id="modal-fecha">-</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">NIT:</span>
                                        <span class="detail-value" id="modal-nit">-</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">Valor:</span>
                                        <span class="detail-value highlight" id="modal-valor">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sección: Información Contable -->
                        <div class="detail-section">
                            <h6 class="section-title">
                                <i data-feather="book"></i> Información Contable
                            </h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">Cuenta:</span>
                                        <span class="detail-value" id="modal-cuenta">-</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">ID Cuenta:</span>
                                        <span class="detail-value" id="modal-id-cuenta">-</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">Tipo Cuenta:</span>
                                        <span class="detail-value" id="modal-tipo-cuenta">-</span>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="detail-item">
                                        <span class="detail-label">Estado:</span>
                                        <span class="detail-value badge-status" id="modal-estado">-</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Sección: Estado Begranda -->
                        <div class="detail-section">
                            <h6 class="section-title">
                                <i data-feather="check-circle"></i> Estado Begranda
                            </h6>
                            <div class="detail-item full-width">
                                <span class="detail-value" id="modal-estado-begranda">-</span>
                            </div>
                        </div>

                        <!-- Sección: Concepto -->
                        <div class="detail-section">
                            <h6 class="section-title">
                                <i data-feather="align-left"></i> Concepto
                            </h6>
                            <div class="detail-item full-width">
                                <p class="detail-value concepto-text" id="modal-concepto">-</p>
                            </div>
                        </div>

                        <!-- Sección: Información Extra -->
                        <div class="detail-section" id="section-extra" style="display: none;">
                            <h6 class="section-title">
                                <i data-feather="layers"></i> Información Adicional
                            </h6>
                            <div class="detail-item full-width">
                                <p class="detail-value" id="modal-extra">-</p>
                            </div>
                        </div>

                        <!-- Sección: Documento -->
                        <div class="detail-section">
                            <h6 class="section-title">
                                <i data-feather="paperclip"></i> Documento de Referencia
                            </h6>
                            <div class="detail-item full-width">
                                <a href="#" id="modal-documento" class="btn btn-outline-primary btn-sm" target="_blank">
                                    <i data-feather="download"></i> Ver/Descargar PDF
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">
                        <i data-feather="x" style="width: 16px; height: 16px;"></i>
                        Cerrar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <style>
        /* Estilos mejorados para el modal de detalles */
        #detallesModal .modal-content {
            border-radius: 15px;
            overflow: hidden;
        }

        #detallesModal .modal-header {
            border-bottom: none;
            padding: 1.5rem;
        }

        #detallesModal .modal-footer {
            border-top: none;
            padding: 1.5rem;
        }

        #detallesModal .detail-section {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            border-left: 4px solid #4099ff;
            transition: all 0.3s ease;
        }

        #detallesModal .detail-section:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transform: translateX(5px);
        }

        #detallesModal .section-title {
            color: #4099ff;
            font-weight: 600;
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            font-size: 1.1rem;
        }

        #detallesModal .section-title i {
            margin-right: 0.5rem;
        }

        #detallesModal .detail-item {
            margin-bottom: 0.75rem;
            padding: 0.5rem 0;
        }

        #detallesModal .detail-label {
            font-weight: 600;
            color: #6c757d;
            display: inline-block;
            min-width: 120px;
            font-size: 0.9rem;
        }

        #detallesModal .detail-value {
            color: #212529;
            font-size: 1rem;
        }

        #detallesModal .detail-value.highlight {
            color: #10b981;
            font-weight: 700;
            font-size: 1.2rem;
        }

        #detallesModal .badge-status {
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        #detallesModal .concepto-text {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #e9ecef;
            line-height: 1.6;
            color: #495057;
        }

        #detallesModal .btn-outline-primary {
            transition: all 0.3s ease;
        }

        #detallesModal .btn-outline-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(64, 153, 255, 0.3);
        }

        #detallesModal .modal-footer .btn {
            padding: 0.6rem 1.5rem;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        #detallesModal .modal-footer .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        #detallesModal .modal-body {
            max-height: 70vh;
            overflow-y: auto;
        }

        #detallesModal .modal-body::-webkit-scrollbar {
            width: 8px;
        }

        #detallesModal .modal-body::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        #detallesModal .modal-body::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 10px;
        }

        #detallesModal .modal-body::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>

    <!-- Warning Section start -->

    <script src="assets/js/vendor-all.min.js"></script>
    <script src="assets/js/plugins/bootstrap.min.js"></script>
    <script src="assets/js/plugins/feather.min.js"></script>
    <script src="assets/js/pcoded.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="assets/js/plugins/clipboard.min.js"></script>
    <script src="assets/js/uikit.min.js"></script>

    <script src="assets/js/plugins/apexcharts.min.js"></script>
    <script src="assets/js/constantes.js"></script>
    <script src="assets/js/actions.js"></script>
    <script src="assets/js/logout.js"></script>



    <script>
        let skip = 0;
        const limit = 100;
        let totalRecords = 0;

        function loadData() {
            const anio = document.getElementById("anio").value;
            const mes = document.getElementById("mes").value;

            const params = new URLSearchParams({
                type: "finalizado",
                skip: skip,
                limit: limit,
            });

            if (anio) {
                params.append('anio', anio);
            }

            if (mes) {
                params.append('mes', mes);
            }

            const url = `${host}/causacionesFinalContables?${params.toString()}`;

            fetch(url, {
                headers: {
                    "accept": "application/json",
                    "Authorization": "Bearer " + token
                }
            })
                .then(response => response.json())
                .then(data => {
                    const tbody = document.querySelector("#data-table tbody");
                    tbody.innerHTML = "";

                    if (data.data && data.data.length > 0) {
                        data.data.forEach(item => {
                            const fecha = new Date(item.begranda);
                            const formato = String(fecha.getDate()).padStart(2, '0') + "/" +
                                String(fecha.getMonth() + 1).padStart(2, '0') + "/" +
                                fecha.getFullYear() + " " +
                                String(fecha.getHours()).padStart(2, '0') + ":" +
                                String(fecha.getMinutes()).padStart(2, '0');
                            const reporte = JSON.parse(item.report_begranda);

                            const finextra = item.extra;
                            // Eliminar los prefijos de forma segura
                            const sinPrefijos = finextra
                                .replace("Id de la cuenta: ", "")
                                .replace(" Tipo de la cuenta: ", "");

                            // Formatear valor como moneda colombiana
                            const valorFormateado = new Intl.NumberFormat('es-CO', {
                                style: 'currency',
                                currency: 'COP',
                                minimumFractionDigits: 0
                            }).format(item.valor);

                            const row = `
                                <tr>
                                <td>${item.id}</td>
                                <td>${new Date(item.fecha).toLocaleDateString('es-CO')}</td>
                                <td>${valorFormateado}</td>
                                <td>${item.id_cuenta}</td>
                                <td>${formato} - ${reporte ? reporte.message : ""} </td>
                                <td>${typeof item.concepto === 'string' && item.concepto.length > 100
                                    ? item.concepto.substring(0, 100) + "..."
                                    : item.concepto}</td>
                                <td>
                                    <button class="btn-action" onclick='mostrarDetalles(${JSON.stringify(item).replace(/'/g, "&apos;")})'>
                                        <i data-feather="eye"></i> Ver detalles
                                    </button>
                                </td>
                                </tr>`;
                            tbody.insertAdjacentHTML("beforeend", row);
                        });

                        totalRecords = data.data.length;
                    } else {
                        tbody.innerHTML = `
                            <tr>
                                <td colspan="7" class="empty-state">
                                    <i data-feather="inbox"></i>
                                    <p>No se encontraron resultados para los filtros seleccionados</p>
                                </td>
                            </tr>`;
                    }

                    // Actualizar estado de paginación
                    updatePaginationState();

                    // Re-inicializar iconos de Feather
                    feather.replace();
                })
                .catch(error => {
                    console.error("Error al obtener datos:", error);
                    const tbody = document.querySelector("#data-table tbody");
                    tbody.innerHTML = `
                        <tr>
                            <td colspan="7" class="empty-state">
                                <i data-feather="alert-circle"></i>
                                <p>Error al cargar los datos. Por favor, intenta nuevamente.</p>
                            </td>
                        </tr>`;
                    feather.replace();
                });
        }

        function updatePaginationState() {
            const currentPage = Math.floor(skip / limit) + 1;
            document.getElementById("page-info").textContent = `Página ${currentPage}`;

            // Deshabilitar botón "Anterior" en la primera página
            const btnPrev = document.getElementById("btn-prev");
            btnPrev.disabled = skip === 0;

            // Deshabilitar botón "Siguiente" si hay menos resultados que el límite
            const btnNext = document.getElementById("btn-next");
            btnNext.disabled = totalRecords < limit;
        }

        function nextPage() {
            skip += limit;
            loadData();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function previousPage() {
            if (skip >= limit) {
                skip -= limit;
                loadData();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        // Función para mostrar detalles en el modal
        function mostrarDetalles(item) {
            // Información General
            document.getElementById('modal-id').textContent = item.id || '-';
            document.getElementById('modal-fecha').textContent = new Date(item.fecha).toLocaleDateString('es-CO', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            document.getElementById('modal-nit').textContent = item.nit || '-';

            // Formatear valor
            const valorFormateado = new Intl.NumberFormat('es-CO', {
                style: 'currency',
                currency: 'COP',
                minimumFractionDigits: 0
            }).format(item.valor);
            document.getElementById('modal-valor').textContent = valorFormateado;

            // Información Contable
            document.getElementById('modal-cuenta').textContent = item.id_cuenta || '-';

            // Procesar extra para obtener ID Cuenta y Tipo Cuenta
            if (item.extra) {
                const sinPrefijos = item.extra
                    .replace("Id de la cuenta: ", "")
                    .replace(" Tipo de la cuenta: ", "");
                const partes = sinPrefijos.split(";");
                document.getElementById('modal-id-cuenta').textContent = partes[0] || '-';
                document.getElementById('modal-tipo-cuenta').textContent = partes[1] || '-';
            } else {
                document.getElementById('modal-id-cuenta').textContent = '-';
                document.getElementById('modal-tipo-cuenta').textContent = '-';
            }

            // Estado
            const estadoElement = document.getElementById('modal-estado');
            estadoElement.textContent = item.estado || 'FINALIZADO';
            estadoElement.className = 'detail-value badge-status';

            // Estado Begranda
            if (item.begranda && item.report_begranda) {
                const fecha = new Date(item.begranda);
                const formato = String(fecha.getDate()).padStart(2, '0') + "/" +
                    String(fecha.getMonth() + 1).padStart(2, '0') + "/" +
                    fecha.getFullYear() + " " +
                    String(fecha.getHours()).padStart(2, '0') + ":" +
                    String(fecha.getMinutes()).padStart(2, '0');

                const reporte = JSON.parse(item.report_begranda);
                document.getElementById('modal-estado-begranda').textContent =
                    `${formato} - ${reporte ? reporte.message : "Sin mensaje"}`;
            } else {
                document.getElementById('modal-estado-begranda').textContent = 'No disponible';
            }

            // Concepto
            document.getElementById('modal-concepto').textContent = item.concepto || 'Sin concepto';

            // Información Extra (si hay más detalles)
            const sectionExtra = document.getElementById('section-extra');
            if (item.extra && item.extra !== '') {
                document.getElementById('modal-extra').textContent = item.extra;
                sectionExtra.style.display = 'block';
            } else {
                sectionExtra.style.display = 'none';
            }

            // Documento
            const documentoLink = document.getElementById('modal-documento');
            if (item.documento_referencia) {
                documentoLink.href = item.documento_referencia;
                documentoLink.style.display = 'inline-flex';
            } else {
                documentoLink.style.display = 'none';
            }

            // Re-inicializar iconos de Feather en el modal
            setTimeout(() => {
                feather.replace();
            }, 100);

            // Mostrar el modal
            $('#detallesModal').modal('show');
        }

        window.onload = () => {
            loadData();
            // Inicializar iconos de Feather
            feather.replace();
        };
    </script>


    <script>

        function JsonMonthYearPicker(jsonData, onMonthYearChange) {
            let currentIndex = 0;
            const pickerElement = document.createElement('div');
            pickerElement.classList.add('month-year-picker');

            const prevButton = document.createElement('button');
            prevButton.classList.add('nav-button', 'prev-item');
            prevButton.textContent = '<';

            const nextButton = document.createElement('button');
            nextButton.classList.add('nav-button', 'next-item');
            nextButton.textContent = '>';

            const monthYearDisplay = document.createElement('span');
            monthYearDisplay.classList.add('current-month-year');
            updateDisplay();

            function updateDisplay() {
                if (jsonData && jsonData.length > 0 && jsonData[currentIndex]) {
                    monthYearDisplay.textContent = `${jsonData[currentIndex].mes} ${jsonData[currentIndex].anio}`;
                    const selectedMonthYear = `${jsonData[currentIndex].anio}/${getMonthNumber(jsonData[currentIndex].mes)}`;
                    if (onMonthYearChange) {
                        onMonthYearChange(selectedMonthYear);
                    }
                } else {
                    monthYearDisplay.textContent = "No hay datos";
                    if (onMonthYearChange) {
                        onMonthYearChange(null);
                    }
                }
            }

            function getMonthNumber(monthName) {
                const monthNames = ["enero", "febrero", "marzo", "abril", "mayo", "junio", "julio", "agosto", "septiembre", "octubre", "noviembre", "diciembre"];
                const lowerCaseMonth = monthName.toLowerCase();
                const index = monthNames.indexOf(lowerCaseMonth);
                return index === -1 ? null : (index + 1).toString().padStart(2, '0');
            }

            prevButton.addEventListener('click', () => {
                if (jsonData && currentIndex > 0) {
                    currentIndex--;
                    updateDisplay();
                }
            });

            nextButton.addEventListener('click', (e) => {
                if (jsonData && currentIndex < jsonData.length - 1) {
                    currentIndex++;
                    updateDisplay();
                }
            });

            pickerElement.appendChild(prevButton);
            pickerElement.appendChild(monthYearDisplay);
            pickerElement.appendChild(nextButton);

            return pickerElement;
        }

        // (El CSS de antes también se aplica aquí)
        const style = document.createElement('style');
        style.textContent = `
        .month-year-picker {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-transform: uppercase; 
        }

        .nav-button {
            padding: 8px 12px;
            cursor: pointer;
            border: none;
            background-color: #f0f0f0;
            border-radius: 3px;
        }

        .nav-button:hover {
            background-color: #e0e0e0;
        }

        .current-month-year {
            font-size: 1.2em;
            font-weight: bold;
        }
        .month-year-picker:nth-child(1){
            display:none; 
        }
        `;
        document.head.appendChild(style);

        const jsonData = [
            { "anio": "2025", "mes": "febrero" },
        ];

        const picker = JsonMonthYearPicker(jsonData, (selected) => {
            console.warn("Mes/Año seleccionado (JSON):", selected);
        });

        // console.log(picker);

        document.body.appendChild(picker);



    </script>

</body>

</html>