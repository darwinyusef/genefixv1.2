<!DOCTYPE html>
<html lang="en">

<head>
    <title>Genefix | Home</title>
    <!-- HTML5 Shim and Respond.js IE11 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 11]>
    	<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    	<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    	<![endif]-->
    <!-- Meta -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="description" content="" />
    <meta name="keywords" content="">
    <meta name="author" content="Phoenixcoded" />

    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="theme-color" content="#ffffff">

    <!-- font css -->
    <link rel="stylesheet" href="assets/fonts/font-awsome-pro/css/pro.min.css">
    <link rel="stylesheet" href="assets/fonts/feather.css">
    <link rel="stylesheet" href="assets/fonts/fontawesome.css">

    <!-- vendor css -->
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="assets/css/customizer.css">
    <link id="rol_user" rel="stylesheet" href="assets/css/change_loggin.css">
    <link id="rol_admin" rel="stylesheet" href="assets/css/typeadmin.css">

    <style>
        /* Dashboard Container */
        .dashboard-container {
            padding: 20px 0;
        }

        /* Welcome Section */
        .welcome-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 16px;
            padding: 40px;
            color: white;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .welcome-section h2 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .welcome-section p {
            font-size: 1.1rem;
            opacity: 0.95;
            margin-bottom: 0;
        }

        .welcome-section .user-role {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            padding: 6px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-top: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* Stats Cards */
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            border: none;
            height: 100%;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 4px;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
        }

        .stat-card-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            font-size: 1.8rem;
        }

        .stat-card-icon.purple {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .stat-card-icon.green {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .stat-card-icon.orange {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .stat-card-icon.blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .stat-card-title {
            font-size: 0.9rem;
            color: #6b7280;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 8px;
        }

        .stat-card-value {
            font-size: 2rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 5px;
        }

        .stat-card-subtitle {
            font-size: 0.85rem;
            color: #9ca3af;
        }

        /* Quick Actions */
        .quick-actions {
            margin-top: 30px;
        }

        .quick-action-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
            cursor: pointer;
            text-decoration: none;
            display: block;
            height: 100%;
        }

        .quick-action-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.2);
            text-decoration: none;
        }

        .quick-action-icon {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 2rem;
        }

        .quick-action-icon.purple {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .quick-action-icon.green {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .quick-action-icon.orange {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .quick-action-icon.blue {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .quick-action-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 8px;
        }

        .quick-action-desc {
            font-size: 0.9rem;
            color: #6b7280;
            margin-bottom: 0;
        }

        /* Recent Activity */
        .activity-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-top: 30px;
        }

        .activity-card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .activity-item {
            padding: 15px;
            border-left: 3px solid #e5e7eb;
            margin-bottom: 15px;
            transition: all 0.2s ease;
        }

        .activity-item:hover {
            border-left-color: #667eea;
            background: #f9fafb;
        }

        .activity-item:last-child {
            margin-bottom: 0;
        }

        .activity-time {
            font-size: 0.8rem;
            color: #9ca3af;
            margin-bottom: 5px;
        }

        .activity-text {
            font-size: 0.95rem;
            color: #374151;
            margin-bottom: 0;
        }

        /* Chart Container */
        .chart-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-top: 30px;
        }

        .chart-card-title {
            font-size: 1.3rem;
            font-weight: 700;
            color: #1f2937;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Admin Only Sections */
        .admin-only {
            display: none;
        }

        /* Loading State */
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s ease-in-out infinite;
            border-radius: 8px;
            height: 20px;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .welcome-section {
                padding: 25px;
            }

            .welcome-section h2 {
                font-size: 1.5rem;
            }

            .stat-card-value {
                font-size: 1.5rem;
            }
        }
    </style>

</head>

<body class="">
    <!-- [ Pre-loader ] start -->
    <div class="loader-bg">
        <div class="loader-track">
            <div class="loader-fill"></div>
        </div>
    </div>
    <!-- [ Pre-loader ] End -->
    <!-- [ Mobile header ] start -->
    <div class="pc-mob-header pc-header">
        <div class="pcm-logo">
            <img src="assets/images/logo.png" alt="" class="logo logo-lg">
        </div>
        <div class="pcm-toolbar">
            <a href="#!" class="pc-head-link" id="mobile-collapse">
                <div class="hamburger hamburger--arrowturn">
                    <div class="hamburger-box">
                        <div class="hamburger-inner"></div>
                    </div>
                </div>
                <!-- <i data-feather="menu"></i> -->
            </a>
            <a href="#!" class="pc-head-link" id="headerdrp-collapse">
                <i data-feather="align-right"></i>
            </a>
            <a href="#!" class="pc-head-link" id="header-collapse">
                <i data-feather="more-vertical"></i>
            </a>
        </div>
    </div>
    <!-- [ Mobile header ] End -->

    <!-- [ navigation menu ] start -->
    <nav class="pc-sidebar ">
        <div class="navbar-wrapper">
            <div class="m-header">
                <a href="home.html" class="b-brand">
                    <!-- ========   change your logo hear   ============ -->
                    <img src="assets/images/logo.png" alt="" class="logo logo-lg">
                    <img src="assets/images/logo-sm.png" alt="" class="logo logo-sm">
                </a>
            </div>
            <div class="navbar-content">
                <ul id="pc-navbar" class="pc-navbar"></ul>
            </div>
        </div>
    </nav>
    <!-- [ navigation menu ] end -->
    <!-- [ Header ] start -->
    <header class="pc-header ">
        <div class="header-wrapper">
            <div class="mr-auto pc-mob-drp">
                <ul class="list-unstyled">
                    <li class="dropdown pc-h-item">
                        <a class="btn_acciones pc-head-link active dropdown-toggle arrow-none mr-0"
                            data-toggle="dropdown" href="#" role="button" aria-haspopup="false" aria-expanded="false">
                            Acciones
                        </a>
                        <div class="dropdown-menu pc-h-dropdown">
                            <a href="profile-update.html" class="dropdown-item">
                                <i data-feather="user"></i>
                                <span>Perfil</span>
                            </a>
                            <!-- <a href="#!" class="dropdown-item">
                                <i data-feather="life-buoy"></i>
                                <span>Support</span>
                            </a> -->
                            <button onclick="logout()" class="dropdown-item">
                                <i data-feather="power"></i>
                                <span>Logout</span>
                            </button>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="ml-auto">
                <ul class="list-unstyled">
                    <li class="dropdown pc-h-item">
                       
                        <div class="dropdown-menu dropdown-menu-right pc-h-dropdown drp-search">
                            <form class="px-3">
                                <div class="form-group mb-0 d-flex align-items-center">
                                    <i data-feather="search"></i>
                                    <input type="search" class="form-control border-0 shadow-none"
                                        placeholder="Search here. . .">
                                </div>
                            </form>
                        </div>
                    </li>
                    <li class="dropdown pc-h-item">
                        <a class="pc-head-link dropdown-toggle arrow-none mr-0" data-toggle="dropdown" href="#"
                            role="button" aria-haspopup="false" aria-expanded="false">
                            <img src="assets/images/user/avatar-5.jpg" alt="user-image" class="user-avtar">
                            <span>
                                <span class="user-name"></span>
                                <span class="user-desc"></span>
                            </span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right pc-h-dropdown">
                            <div class=" dropdown-header">
                                <h6 class="text-overflow m-0">Bienvenido</h6>
                            </div>
                            <a href="profile-update.html" class="dropdown-item">
                                <i data-feather="user"></i>
                                <span>Mi perfil</span>
                            </a>

                            <!-- <a href="#!" class="dropdown-item">
                                <i data-feather="life-buoy"></i>
                                <span>Support</span>
                            </a> -->

                            <button onclick="logout()" class="dropdown-item">
                                <i data-feather="power"></i>
                                <span>Logout</span>
                            </button>
                        </div>
                    </li>
                </ul>
            </div>

        </div>
    </header>
    <!-- [ Header ] end -->

    <!-- [ Main Content ] start -->
    <div class="pc-container">
        <div class="pcoded-content">
            <!-- [ breadcrumb ] start -->
            <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <h5 class="m-b-10">Inicio</h5>
                            </div>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="home.html">Bienvenida</a></li>
                                <!--li class="breadcrumb-item">Sample Page</li-->
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
            <!-- [ breadcrumb ] end -->
            <!-- [ Main Content ] start -->
            <div class="dashboard-container">

                <!-- Welcome Section -->
                <div class="row">
                    <div class="col-12">
                        <div class="welcome-section">
                            <h2>Bienvenido, <span id="nombreUsuario"></span>! </h2>
                            <p>Este es tu panel de control donde podr谩s gestionar tus causaciones contables y visualizar estad铆sticas</p>
                            <span class="user-role" id="userRole">Usuario</span>
                        </div>
                    </div>
                </div>

                <!-- Stats Cards -->
                <div class="row">
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-card-icon purple">
                                <i data-feather="file-text"></i>
                            </div>
                            <div class="stat-card-title">Total Causaciones</div>
                            <div class="stat-card-value" id="totalCausaciones">0</div>
                            <div class="stat-card-subtitle">En todo el sistema</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-card-icon green">
                                <i data-feather="check-circle"></i>
                            </div>
                            <div class="stat-card-title">Finalizadas</div>
                            <div class="stat-card-value" id="causacionesFinalizadas">0</div>
                            <div class="stat-card-subtitle">Completadas</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-4">
                        <div class="stat-card">
                            <div class="stat-card-icon orange">
                                <i data-feather="clock"></i>
                            </div>
                            <div class="stat-card-title">Pendientes</div>
                            <div class="stat-card-value" id="causacionesPendientes">0</div>
                            <div class="stat-card-subtitle">Por procesar</div>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6 mb-4 admin-only">
                        <div class="stat-card">
                            <div class="stat-card-icon blue">
                                <i data-feather="users"></i>
                            </div>
                            <div class="stat-card-title">Usuarios</div>
                            <div class="stat-card-value" id="totalUsuarios">0</div>
                            <div class="stat-card-subtitle">Registrados</div>
                        </div>
                    </div>
                </div>

                <!-- Quick Actions -->
                <div class="quick-actions">
                    <div class="row">
                        <div class="col-12 mb-3">
                            <h4 style="font-weight: 700; color: #1f2937;">
                                <i data-feather="zap"></i> Acciones R谩pidas
                            </h4>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-4">
                            <a href="./causacioncontable_new.html" class="quick-action-card">
                                <div class="quick-action-icon purple">
                                    <i data-feather="plus-circle"></i>
                                </div>
                                <div class="quick-action-title">Nueva Causaci贸n</div>
                                <p class="quick-action-desc">Crear una nueva causaci贸n contable</p>
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-4">
                            <a href="./causacioncontable_report.html" class="quick-action-card">
                                <div class="quick-action-icon green">
                                    <i data-feather="bar-chart-2"></i>
                                </div>
                                <div class="quick-action-title">Ver Reportes</div>
                                <p class="quick-action-desc">Consultar reportes finalizados</p>
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-4">
                            <a href="./profile-update.html" class="quick-action-card">
                                <div class="quick-action-icon orange">
                                    <i data-feather="user"></i>
                                </div>
                                <div class="quick-action-title">Mi Perfil</div>
                                <p class="quick-action-desc">Actualizar informaci贸n personal</p>
                            </a>
                        </div>
                        <div class="col-md-3 col-sm-6 mb-4 admin-only">
                            <a href="./users.html" class="quick-action-card">
                                <div class="quick-action-icon blue">
                                    <i data-feather="users"></i>
                                </div>
                                <div class="quick-action-title">Gesti贸n Usuarios</div>
                                <p class="quick-action-desc">Administrar usuarios del sistema</p>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Charts and Recent Activity -->
                <div class="row">
                    <!-- Chart -->
                    <div class="col-md-8">
                        <div class="chart-card">
                            <h5 class="chart-card-title">
                                <i data-feather="trending-up"></i> Causaciones por Mes
                            </h5>
                            <div id="causacionesChart"></div>
                        </div>
                    </div>

                    <!-- Recent Activity -->
                    <div class="col-md-4">
                        <div class="activity-card">
                            <h5 class="activity-card-title">
                                <i data-feather="activity"></i> Actividad Reciente
                            </h5>
                            <div id="recentActivity">
                                <div class="text-center py-4">
                                    <div class="loading-skeleton mb-2"></div>
                                    <div class="loading-skeleton mb-2"></div>
                                    <div class="loading-skeleton"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <!-- [ Main Content ] end -->
        </div>
    </div>
    <!-- [ Main Content ] end -->
    </div>

    <script src="assets/js/vendor-all.min.js"></script>
    <script src="assets/js/plugins/bootstrap.min.js"></script>
    <script src="assets/js/plugins/feather.min.js"></script>
    <script src="assets/js/pcoded.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="assets/js/plugins/clipboard.min.js"></script>
    <script src="assets/js/uikit.min.js"></script>

    <script src="assets/js/plugins/apexcharts.min.js"></script>
    <script src="assets/js/constantes.js"></script>
    <script src="assets/js/actions.js"></script>
    <script src="assets/js/logout.js"></script>

    <script>
        const usuarioObj = JSON.parse(localStorage.getItem("user"));

        // Mostrar nombre de usuario
        document.getElementById('nombreUsuario').textContent = usuarioObj.name;

        // Mostrar rol y elementos espec铆ficos del admin
        if (usuarioObj.rol === 'admin') {
            document.getElementById('userRole').textContent = 'Administrador';
            document.querySelectorAll('.admin-only').forEach(el => {
                el.style.display = 'block';
            });
        } else {
            document.getElementById('userRole').textContent = 'Usuario';
        }

        // Funci贸n para cargar estad铆sticas
        async function cargarEstadisticas() {
            try {
                // Cargar todas las causaciones
                const response = await fetch(`${host}/causacionesFinalContables?type=finalizado&skip=0&limit=1000`, {
                    headers: {
                        'accept': 'application/json',
                        'Authorization': `Bearer ${token}`
                    }
                });

                if (response.ok) {
                    const data = await response.json();
                    const causaciones = data.data || [];

                    // Total de causaciones
                    document.getElementById('totalCausaciones').textContent = causaciones.length;

                    // Contar finalizadas (todas las que vienen de este endpoint son finalizadas)
                    document.getElementById('causacionesFinalizadas').textContent = causaciones.length;

                    // Cargar causaciones pendientes
                    const responsePendientes = await fetch(`${host}/causacionContable`, {
                        headers: {
                            'Authorization': `Bearer ${token}`,
                            'Content-Type': 'application/json'
                        }
                    });

                    if (responsePendientes.ok) {
                        const dataPendientes = await responsePendientes.json();
                        const pendientes = Array.isArray(dataPendientes) ? dataPendientes.length : 0;
                        document.getElementById('causacionesPendientes').textContent = pendientes;
                    }

                    // Procesar datos para el gr谩fico
                    procesarDatosGrafico(causaciones);

                    // Mostrar actividad reciente
                    mostrarActividadReciente(causaciones);
                }
            } catch (error) {
                console.error('Error al cargar estad铆sticas:', error);
            }
        }

        // Funci贸n para procesar datos del gr谩fico
        function procesarDatosGrafico(causaciones) {
            // Agrupar por mes
            const causacionesPorMes = {};
            const mesesOrdenados = [];

            causaciones.forEach(item => {
                if (item.fecha) {
                    const fecha = new Date(item.fecha);
                    const mesAnio = `${fecha.getFullYear()}-${String(fecha.getMonth() + 1).padStart(2, '0')}`;
                    const mesNombre = fecha.toLocaleDateString('es-CO', { month: 'short', year: 'numeric' });

                    if (!causacionesPorMes[mesAnio]) {
                        causacionesPorMes[mesAnio] = {
                            count: 0,
                            label: mesNombre
                        };
                    }
                    causacionesPorMes[mesAnio].count++;
                }
            });

            // Ordenar por mes
            const mesesKeys = Object.keys(causacionesPorMes).sort();
            const ultimos6Meses = mesesKeys.slice(-6);

            const labels = ultimos6Meses.map(key => causacionesPorMes[key].label);
            const valores = ultimos6Meses.map(key => causacionesPorMes[key].count);

            // Crear gr谩fico
            crearGrafico(labels, valores);
        }

        // Funci贸n para crear el gr谩fico
        function crearGrafico(labels, valores) {
            const options = {
                series: [{
                    name: 'Causaciones',
                    data: valores
                }],
                chart: {
                    type: 'area',
                    height: 300,
                    toolbar: {
                        show: false
                    }
                },
                colors: ['#667eea'],
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: 'smooth',
                    width: 3
                },
                fill: {
                    type: 'gradient',
                    gradient: {
                        shadeIntensity: 1,
                        opacityFrom: 0.7,
                        opacityTo: 0.2,
                        stops: [0, 90, 100]
                    }
                },
                xaxis: {
                    categories: labels,
                    labels: {
                        style: {
                            colors: '#6b7280'
                        }
                    }
                },
                yaxis: {
                    labels: {
                        style: {
                            colors: '#6b7280'
                        }
                    }
                },
                grid: {
                    borderColor: '#e5e7eb',
                    strokeDashArray: 4
                },
                tooltip: {
                    theme: 'light',
                    y: {
                        formatter: function (val) {
                            return val + ' causaciones'
                        }
                    }
                }
            };

            const chart = new ApexCharts(document.querySelector("#causacionesChart"), options);
            chart.render();
        }

        // Funci贸n para mostrar actividad reciente
        function mostrarActividadReciente(causaciones) {
            const recentActivity = document.getElementById('recentActivity');
            const ultimas5 = causaciones.slice(-5).reverse();

            if (ultimas5.length === 0) {
                recentActivity.innerHTML = `
                    <div class="text-center py-4" style="color: #9ca3af;">
                        <i data-feather="inbox" style="width: 40px; height: 40px; opacity: 0.5;"></i>
                        <p class="mt-2">No hay actividad reciente</p>
                    </div>
                `;
            } else {
                recentActivity.innerHTML = ultimas5.map(item => {
                    const fecha = new Date(item.fecha);
                    const fechaFormateada = fecha.toLocaleDateString('es-CO', {
                        day: 'numeric',
                        month: 'short',
                        year: 'numeric'
                    });

                    const valorFormateado = new Intl.NumberFormat('es-CO', {
                        style: 'currency',
                        currency: 'COP',
                        minimumFractionDigits: 0
                    }).format(item.valor);

                    return `
                        <div class="activity-item">
                            <div class="activity-time">${fechaFormateada}</div>
                            <div class="activity-text">Causaci贸n #${item.id} - ${valorFormateado}</div>
                        </div>
                    `;
                }).join('');
            }

            // Re-inicializar iconos de Feather
            feather.replace();
        }

        // Funci贸n para cargar usuarios (solo admin)
        async function cargarUsuarios() {
            if (usuarioObj.rol === 'admin') {
                try {
                    const response = await fetch(`${host}/users`, {
                        headers: {
                            'accept': 'application/json',
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (response.ok) {
                        const data = await response.json();
                        const usuarios = Array.isArray(data) ? data : (data.data || []);
                        document.getElementById('totalUsuarios').textContent = usuarios.length;
                    }
                } catch (error) {
                    console.error('Error al cargar usuarios:', error);
                }
            }
        }

        // Cargar todos los datos al iniciar
        window.addEventListener('DOMContentLoaded', () => {
            cargarEstadisticas();
            cargarUsuarios();
            feather.replace();
        });
    </script>
</body>

</html>